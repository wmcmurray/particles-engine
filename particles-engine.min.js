(function(window){function Vector(x,y,z){if(x instanceof Vector){y=x.y;z=x.z;x=x.x}this.x=x;this.y=y;this.z=z}var p=Vector.prototype;p.apply=function(vector,deltaTime,multiplier){var m=typeof deltaTime!="undefined"?deltaTime/1E3:1;var m2=multiplier?multiplier:1;this.x+=vector.x*m*m2;this.y+=vector.y*m*m2;this.z+=vector.z*m*m2;return this};p.multiply=function(amount){this.x*=amount;this.y*=amount;this.z*=amount;return this};p.divide=function(amount){this.x/=amount;this.y/=amount;this.z/=amount;return this};
p.substract=function(amount){this.x-=amount;this.y-=amount;this.z-=amount;return this};p.substractVector=function(vector){this.x-=vector.x;this.y-=vector.y;this.z-=vector.z;return this};p.toString=function(){return"["+Math.round(this.x)+","+Math.round(this.y)+","+Math.round(this.z)+"]"};window.Vector=Vector})(window);(function(window){function ParticlesEngineParticle(params){this.params={type:"default",src:"",style:{},size:5,mass:1,lifetime:2,fade:true,rotate:new Vector(0,0,1),inheritVelocity:1,sticky:false,round:false,solid:false};for(var i in params)this.params[i]=params[i];this.emitterRef;this.parent;this.view;this.pos=new Vector(0,0,0);this.vel=new Vector(0,0,0);this.rot=new Vector(0,0,0);this.init()}var p=ParticlesEngineParticle.prototype;p.init=function(){this.view=document.createElement(this.params.src?
"img":"div");this.view.className="particle "+this.params.type;this.resize(this.params.size);if(this.params.rotate){var o={};if(this.params.rotate.x)o.rotationX=this.rot.x=Math.random()*(360*this.params.rotate.x);if(this.params.rotate.y)o.rotationY=this.rot.y=Math.random()*(360*this.params.rotate.y);if(this.params.rotate.z)o.rotationZ=this.rot.z=Math.random()*(360*this.params.rotate.z);TweenMax.to(this.view,0,o)}if(this.params.src)this.view.src=this.params.src;if(this.params.style)jQuery(this.view).css(this.params.style);
if(this.params.lifetime){this.bornOn=(new Date).getTime();setTimeout(jQuery.proxy(this.kill,this),this.params.lifetime*1E3)}};p.getLifeSpent=function(){if(this.params.lifetime){var now=(new Date).getTime();var timeSpent=now-this.bornOn;var max=this.params.lifetime*1E3;return timeSpent/max}return false};p.inject=function(parent){this.parent=parent;this.parent.appendChild(this.view);return this};p.place=function(x,y,z){TweenMax.to(this.view,0,{x:-(jQuery(this.view).outerWidth()*0.5)+x,y:-(jQuery(this.view).outerHeight()*
0.5)+y,z:z});this.view.style.zIndex=z;return this};p.resize=function(size){if(Object.prototype.toString.call(size)==="[object Array]"&&(size[0]&&size[1]))size=size[0]+Math.random()*(size[1]-size[0]);this.params.size=size;this.view.style.width=size+"px";this.view.style.height=size+"px";if(this.params.round)jQuery(this.view).css({borderRadius:this.params.size*0.5+"px"});return this};p.applyForce=function(vector,deltatime,multiplier){this.vel.apply(vector,deltatime,multiplier?multiplier:1);return this};
p.update=function(deltatime){if(this.params.solid)if(this.pos.z<0&&this.vel.z<0)this.vel.z=-this.vel.z*0.75;this.pos.apply(this.vel,deltatime);if(!ParticlesEngine.params.canvas||this.emitterRef.params.relative)this.place(this.pos.x,this.pos.y,this.pos.z);if(this.params.lifetime&&this.params.fade){var o=1-this.getLifeSpent();jQuery(this.view).css({opacity:o>0?o:0})}return this};p.kill=function(){if(this.parent)this.parent.removeChild(this.view);this.killed=true;return this};window.ParticlesEngineParticle=
ParticlesEngineParticle})(window);(function(window){function ParticlesEngineEmitter(parent,params){this.params={relative:false,fixed:false,pps:5,limit:0,particles:{},autoStart:false,from:"center",spread:500};for(var i in params)this.params[i]=params[i];this.lastPosRefreshTime=false;this.parent=parent?jQuery(parent)[0]:document.body;this.container=this.params.relative?jQuery(this.parent)[0]:ParticlesEngine.view;this.pos=new Vector(0,0,0);this.vel=new Vector(0,0,0);this.width=0;this.height=0;this.counter=0;this.loopInterval;this.particles=
new Array;this.init()}var p=ParticlesEngineEmitter.prototype;p.init=function(){jQuery(this.container).css({transformStyle:"preserve-3d"});this.refreshPos();if(!this.parent.emitters)this.parent.emitters=new Array;this.parent.emitters.push(this);if(this.params.autoStart)this.start()};p.start=function(){this.stop();this.loopInterval=setInterval(jQuery.proxy(this.createParticle,this),1E3/this.params.pps);jQuery(this.parent).addClass("emitting");return this};p.stop=function(){if(this.loopInterval){clearInterval(this.loopInterval);
this.loopInterval=false;jQuery(this.parent).removeClass("emitting")}return this};p.reset=function(){this.counter=0;return this};p.burst=function(amount){if(!this.params.fixed&&!this.params.relative)this.refreshPos();for(var i=0;i<amount;i++)this.createParticle(true);return this};p.toogle=function(){if(this.loopInterval)this.stop();else this.start();return this};p.refreshPos=function(){var p=jQuery(this.parent);this.width=p.width();this.height=p.height();if(!this.params.relative){var o=p.offset();
this.pos.x=o.left+this.width*0.5;this.pos.y=o.top+this.height*0.5;this.pos.z=0}else{this.pos.x=this.width*0.5;this.pos.y=this.height*0.5;this.pos.z=0}var now=(new Date).getTime();if(this.lastPosRefreshTime){var deltaTime=now-this.lastPosRefreshTime;var pos=new Vector(this.pos);pos.substractVector(this.lastPosRefreshPos);if(deltaTime)pos.multiply(1E3/deltaTime);this.vel=pos}this.lastPosRefreshTime=now;this.lastPosRefreshPos=new Vector(this.pos)};p.createParticle=function(ommitPosRefresh){if(this.params.limit&&
++this.counter>=this.params.limit){this.stop();return false}else{if(!ommitPosRefresh&&(!this.params.fixed&&!this.params.relative))this.refreshPos();var p=new ParticlesEngineParticle(this.params.particles);p.emitterRef=this;p.pos.apply(this.pos);var values=this.params.from.split(" ");if(values.length<2)switch(values[0]){case "top":case "bottom":values.push(values[0]);values[0]="random";break;case "left":case "right":values.push("random");break;default:values.push(values[0]);break}if(values[0]=="left")values[0]=
0;else if(values[0]=="right")values[0]=1;else if(values[0]=="center")values[0]=0.5;else if(values[0]=="random")values[0]=Math.random();else values[0]=Number(values[0]);if(values[1]=="top")values[1]=0;else if(values[1]=="bottom")values[1]=1;else if(values[1]=="center")values[1]=0.5;else if(values[1]=="random")values[1]=Math.random();else values[1]=Number(values[1]);var newPos=new Vector(this.width*(values[0]-0.5),this.height*(values[1]-0.5),0);p.pos.apply(newPos);if(p.params.inheritVelocity){var v=
new Vector(this.vel);v.multiply(p.params.inheritVelocity);p.vel.apply(v)}if(this.params.spread){var m=this.params.spread;var x=Math.random()*m-m/2;var y=Math.random()*m-m/2;var z=Math.random()*m-m/2;p.vel.apply(new Vector(x,y,z))}p.place(p.pos.x,p.pos.y,p.pos.z);if(!ParticlesEngine.params.canvas||this.params.relative)p.inject(this.container);this.particles.push(p);return p}};window.ParticlesEngineEmitter=ParticlesEngineEmitter})(window);(function(window){function ParticlesEngineEnvironment(params){this.params={container:false,friction:0.1,gravity:new Vector(0,300,0)};for(var i in params)this.params[i]=params[i];this.emitters=new Array;this.init()}var p=ParticlesEngineEnvironment.prototype;p.init=function(){};p.startEmitters=function(){for(var i in this.emitters)this.emitters[i].start()};p.stopEmitters=function(){for(var i in this.emitters)this.emitters[i].stop()};p.refreshEmitters=function(){for(var i in this.emitters)if(!this.emitters[i].params.fixed)this.emitters[i].refreshPos()};
p.createEmitter=function(parent,params){var e=new ParticlesEngineEmitter(parent,params);this.emitters.push(e);return e};window.ParticlesEngineEnvironment=ParticlesEngineEnvironment})(window);(function(window){function ParticlesEngineDisplayer(){this.params={fps:30,RAF:true,perspective:600,canvas:false};this.loopInterval;this.lastFrame;this.environments=new Array;this.scrollTop=0;this.scrollLeft=0}var p=ParticlesEngineDisplayer.prototype;p.init=function(params){this.setParams(params);this.view=document.createElement(this.params.canvas?"canvas":"div");this.view.className="particles-engine-display"+(this.params.canvas?"-canvas":"");document.body.appendChild(this.view);if(this.params.canvas)this.ctx=
this.view.getContext("2d");else TweenMax.to(this.view,0,{perspective:this.params.perspective});jQuery(window).resize(jQuery.proxy(this.resizeScene,this));jQuery(window).scroll(jQuery.proxy(this.scrollScene,this));this.resizeScene();this.scrollScene();this.start()};p.setParams=function(params){for(var i in params)this.params[i]=params[i]};p.resizeScene=function(){if(this.params.canvas){var win=jQuery(window);this.view.width=win.width();this.view.height=win.height()}else jQuery(this.view).css({height:jQuery("html").height()})};
p.scrollScene=function(){var win=jQuery(window);var p=jQuery(this.view);this.scrollTop=win.scrollTop();this.scrollLeft=win.scrollLeft();if(this.params.canvas){this.view.style.top=this.scrollTop+"px";this.view.style.left=this.scrollLeft+"px"}else{var w=p.width();var h=p.height();var perctTop=Math.round((this.scrollTop+win.height()*0.5)*100/h);var perctLeft=Math.round((this.scrollLeft+win.width()*0.5)*100/w);TweenMax.to(this.view,0,{perspectiveOrigin:perctLeft+"% "+perctTop+"%"})}};p.start=function(){this.stop();
this.lastFrame=getTime();if(this.params.RAF)this.loopRequest=window.requestAnimationFrame(jQuery.proxy(this.update,this));else this.loopInterval=setInterval(jQuery.proxy(this.update,this),1E3/this.params.fps)};p.stop=function(){if(this.loopRequest)window.cancelAnimationFrame(this.loopRequest);if(this.loopInterval)clearInterval(this.loopInterval)};p.update=function(){var now=getTime();var deltaTime=now-this.lastFrame;if(this.params.canvas){this.ctx.setTransform(1,0,0,1,0,0);this.ctx.clearRect(0,0,
this.view.width,this.view.height)}for(var i in this.environments){var environment=this.environments[i];for(var j in environment.emitters){var emitter=environment.emitters[j];for(var k in emitter.particles){var p=emitter.particles[k];if(p.killed)delete emitter.particles[k];else{if(p.params.mass!=0)p.applyForce(environment.params.gravity,deltaTime,p.params.mass);if(environment.params.friction)p.vel.multiply(1-environment.params.friction);if(p.params.sticky){var stickyVel=new Vector(emitter.pos);stickyVel.substractVector(p.pos).multiply(p.params.sticky);
p.applyForce(stickyVel,deltaTime,1)}p.update(deltaTime);if(this.params.canvas&&!emitter.params.relative){var x=p.pos.x;var y=p.pos.y;var z=p.pos.z;var size=p.params.size;var scale=1+z/50;var rot=p.rot.z*(Math.PI/180);var midSize=size*0.5;x-=this.scrollLeft;y-=this.scrollTop;this.ctx.globalAlpha=p.view.style.opacity;this.ctx.globalCompositeOperation="lighter";this.ctx.setTransform(scale,0,0,scale,x,y);this.ctx.rotate(rot);if(p.params.src)this.ctx.drawImage(p.view,-midSize,-midSize,size,size);else{this.ctx.fillStyle=
jQuery(p.view).css("background-color");if(p.params.round){this.ctx.beginPath();this.ctx.arc(0,0,size,0,2*Math.PI);this.ctx.fill()}else this.ctx.fillRect(0,0,size,size)}}}}}}this.lastFrame=now;if(this.params.RAF)this.loopRequest=requestAnimationFrame(jQuery.proxy(this.update,this))};p.createEnvironment=function(params){var e=new ParticlesEngineEnvironment(params);this.environments.push(e);return e};function getTime(){var d=new Date;return d.getTime()}window.ParticlesEngine=new ParticlesEngineDisplayer})(window);
